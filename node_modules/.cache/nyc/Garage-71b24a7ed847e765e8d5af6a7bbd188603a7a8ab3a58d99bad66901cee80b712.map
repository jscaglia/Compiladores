{"version":3,"file":"C:/Compiladores/Compiladores/src/Infraestructure/Class/Garage.ts","sources":["C:/Compiladores/Compiladores/src/Infraestructure/Class/Garage.ts"],"names":[],"mappings":"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","sourcesContent":["import moment from \"moment\";\r\nimport { ICoordenada } from \"../Interfaces/ICoordenada\";\r\nimport { IEspacio } from \"../Interfaces/IEspacio\";\r\nimport { IGarage } from \"../Interfaces/IGarage\";\r\nimport { IPisoGarage } from \"../Interfaces/IPisoGarage\";\r\nimport { IVehiculo } from \"../Interfaces/IVehiculo\";\r\nimport { Coordenada } from \"./Coordenada\";\r\nimport { PisoGarage } from \"./PisoGarage\";\r\nimport { NoVehiculo } from \"./Vehiculos/NoVehiculo\";\r\n\r\nexport class Garage implements IGarage {\r\n\r\n    public PisosGarage: Array<IPisoGarage>;\r\n\r\n    public constructor(piso: number, espacios: number) {\r\n        this.PisosGarage = new Array<PisoGarage>(piso);\r\n\r\n        for (var i = 0; i < this.PisosGarage.length; i++) {\r\n            this.PisosGarage[i] = new PisoGarage(espacios, i);\r\n        }\r\n    }\r\n\r\n\r\n    public GetPrimerLugarLibre(): ICoordenada | null {\r\n        let coordenadaResult: Coordenada = new Coordenada(-1, -1);\r\n        let mustBreak: boolean = false;\r\n\r\n        this.PisosGarage.forEach((piso: PisoGarage, i: number) => {\r\n            if(!mustBreak){\r\n                piso.Espacios.forEach((espacio: IEspacio, j: number) => {\r\n                    if (!espacio.Ocupado && !mustBreak) {\r\n                        mustBreak = true;\r\n                        coordenadaResult = new Coordenada(espacio.Coordenada.Piso, espacio.Coordenada.Espacio);\r\n                    }\r\n                })\r\n            }\r\n        });\r\n\r\n        if(mustBreak){\r\n            return coordenadaResult;\r\n        }\r\n\r\n        return null;\r\n    }\r\n\r\n    public GuardarVehiculo(vehiculo: IVehiculo): ICoordenada | null {\r\n        let coordenada: ICoordenada | null = null;\r\n        let isBreak: boolean = false;\r\n\r\n        this.PisosGarage.forEach((piso: PisoGarage, i: number) => {\r\n            if (!isBreak) {\r\n                piso.Espacios.forEach((espacio: IEspacio, j: number) => {\r\n                    if (!espacio.Ocupado && !isBreak) {\r\n                        espacio.Ocupado = true;\r\n                        espacio.OcupadoPor = vehiculo;\r\n                        coordenada = espacio.Coordenada;\r\n                        isBreak = true;\r\n                    }\r\n                })\r\n            }\r\n        });\r\n\r\n        return coordenada;\r\n    }\r\n\r\n    public GuardarVehiculoPosicion(vehiculo: IVehiculo, piso: number, posicion: number): ICoordenada | null{\r\n        try {\r\n            if (this.checkPosicion(piso, posicion)) {\r\n                this.PisosGarage[piso].Espacios[posicion].Ocupado = true;\r\n                this.PisosGarage[piso].Espacios[posicion].OcupadoPor = vehiculo;\r\n                this.PisosGarage[piso].Espacios[posicion].Tiempo = new Date();\r\n                return this.PisosGarage[piso].Espacios[posicion].Coordenada;\r\n            }\r\n\r\n            return null;\r\n        }\r\n        catch (e) {\r\n            return e;\r\n        }\r\n    }\r\n\r\n    public QuitarVehiculo(piso: number, posicion: number): number {\r\n        try {\r\n\r\n            let monto: number = 0;\r\n\r\n            if (this.checkPosicionUnPark(piso, posicion)) {\r\n                let fechaFin = new Date().getTime();\r\n                let duracion = fechaFin - this.PisosGarage[piso].Espacios[posicion].Tiempo.getTime();\r\n\r\n                monto = Math.floor(duracion/60/60) * this.PisosGarage[piso].Espacios[posicion].OcupadoPor.Tarifa;\r\n                \r\n                this.PisosGarage[piso].Espacios[posicion].Ocupado = false;\r\n                this.PisosGarage[piso].Espacios[posicion].OcupadoPor = new NoVehiculo();\r\n            }\r\n\r\n            return monto;\r\n        }\r\n        catch (e) {\r\n            console.log(e);\r\n            return -1;\r\n        }\r\n    }\r\n\r\n    private checkPosicionUnPark(piso: number, posicion: number): boolean {\r\n        try {\r\n            if (this.PisosGarage[piso] === null || this.PisosGarage[piso] === undefined) {\r\n                throw new Error('No existe ese piso.');\r\n            }\r\n\r\n            if (this.PisosGarage[piso].CantidadEspacios < posicion) {\r\n                throw new Error('No existe esa posición.');\r\n            }\r\n\r\n            if (!this.PisosGarage[piso].Espacios[posicion].Ocupado) {\r\n                throw new Error('Este espacio ya está vacio.');\r\n            }\r\n\r\n            return true;\r\n        }\r\n        catch (e) {\r\n            console.log(e);\r\n            return false;\r\n        }\r\n    }\r\n\r\n    private checkPosicion(piso: number, posicion: number): boolean {\r\n        try {\r\n            if (this.PisosGarage[piso] === null || this.PisosGarage[piso] === undefined) {\r\n                throw new Error('No existe ese piso.');\r\n            }\r\n\r\n            if (this.PisosGarage[piso].CantidadEspacios < posicion) {\r\n                throw new Error('No existe esa posición.');\r\n            }\r\n\r\n            if (this.PisosGarage[piso].Espacios[posicion].Ocupado) {\r\n                throw new Error('Esa posición está ocupada.');\r\n            }\r\n            return true;\r\n        }\r\n        catch (e) {\r\n            console.log(e);\r\n            return false;\r\n        }\r\n    }\r\n}"]}